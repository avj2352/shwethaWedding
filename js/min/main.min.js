!function(e){function o(){e("#canvas").fadeIn(1e3);var i=e(".magazine");return 0===i.width()||0===i.height()?(setTimeout(o,10),void 0):(i.turn({width:922,height:600,duration:1e3,gradients:!0,autoCenter:!0,elevation:50,pages:12,when:{turning:function(o,i){{var n=e(this);n.turn("page"),n.turn("pages")}Hash.go("page/"+i).update(),disableControls(i)},turned:function(o,i){disableControls(i),e(this).turn("center"),e("#slider").slider("value",getViewNumber(e(this),i)),1==i&&e(this).turn("peel","br")},missing:function(o,i){for(var n=0;n<i.length;n++)addPage(i[n],e(this))}}}),e(".magazine-viewport").zoom({flipbook:e(".magazine"),max:function(){return largeMagazineWidth()/e(".magazine").width()},when:{swipeLeft:function(){e(this).zoom("flipbook").turn("next")},swipeRight:function(){e(this).zoom("flipbook").turn("previous")},resize:function(e,o,i,n){1==o?loadSmallPage(i,n):loadLargePage(i,n)},zoomIn:function(){e("#slider-bar").hide(),e(".made").hide(),e(".magazine").removeClass("animated").addClass("zoom-in"),e(".zoom-icon").removeClass("zoom-icon-in").addClass("zoom-icon-out"),window.escTip||e.isTouch||(escTip=!0,e("<div />",{"class":"exit-message"}).html("<div>Press ESC to exit</div>").appendTo(e("body")).delay(2e3).animate({opacity:0},500,function(){e(this).remove()}))},zoomOut:function(){e("#slider-bar").fadeIn(),e(".exit-message").hide(),e(".made").fadeIn(),e(".zoom-icon").removeClass("zoom-icon-out").addClass("zoom-icon-in"),setTimeout(function(){e(".magazine").addClass("animated").removeClass("zoom-in"),resizeViewport()},0)}}}),e.isTouch?e(".magazine-viewport").bind("zoom.doubleTap",zoomTo):e(".magazine-viewport").bind("zoom.tap",zoomTo),e(document).keydown(function(o){var i=37,n=39,t=27;switch(o.keyCode){case i:e(".magazine").turn("previous"),o.preventDefault();break;case n:e(".magazine").turn("next"),o.preventDefault();break;case t:e(".magazine-viewport").zoom("zoomOut"),o.preventDefault()}}),Hash.on("^page/([0-9]*)$",{yep:function(o,i){var n=i[1];void 0!==n&&e(".magazine").turn("is")&&e(".magazine").turn("page",n)},nop:function(){e(".magazine").turn("is")&&e(".magazine").turn("page",1)}}),e(window).resize(function(){resizeViewport()}).bind("orientationchange",function(){resizeViewport()}),e.isTouch?e(".magazine").bind("touchstart",regionClick):e(".magazine").click(regionClick),e(".next-button").bind(e.mouseEvents.over,function(){e(this).addClass("next-button-hover")}).bind(e.mouseEvents.out,function(){e(this).removeClass("next-button-hover")}).bind(e.mouseEvents.down,function(){e(this).addClass("next-button-down")}).bind(e.mouseEvents.up,function(){e(this).removeClass("next-button-down")}).click(function(){e(".magazine").turn("next")}),e(".previous-button").bind(e.mouseEvents.over,function(){e(this).addClass("previous-button-hover")}).bind(e.mouseEvents.out,function(){e(this).removeClass("previous-button-hover")}).bind(e.mouseEvents.down,function(){e(this).addClass("previous-button-down")}).bind(e.mouseEvents.up,function(){e(this).removeClass("previous-button-down")}).click(function(){e(".magazine").turn("previous")}),e("#slider").slider({min:1,max:numberOfViews(i),start:function(o,i){window._thumbPreview?setPreview(i.value):(_thumbPreview=e("<div />",{"class":"thumbnail"}).html("<div></div>"),setPreview(i.value),_thumbPreview.appendTo(e(i.handle))),moveBar(!1)},slide:function(e,o){setPreview(o.value)},stop:function(){window._thumbPreview&&_thumbPreview.removeClass("show"),e(".magazine").turn("page",Math.max(1,2*e(this).slider("value")-2))}}),resizeViewport(),e(".magazine").addClass("animated"),void 0)}e("body").loadie(),e(".zoom-icon").bind("mouseover",function(){e(this).hasClass("zoom-icon-in")&&e(this).addClass("zoom-icon-in-hover"),e(this).hasClass("zoom-icon-out")&&e(this).addClass("zoom-icon-out-hover")}).bind("mouseout",function(){e(this).hasClass("zoom-icon-in")&&e(this).removeClass("zoom-icon-in-hover"),e(this).hasClass("zoom-icon-out")&&e(this).removeClass("zoom-icon-out-hover")}).bind("click",function(){e(this).hasClass("zoom-icon-in")?e(".magazine-viewport").zoom("zoomIn"):e(this).hasClass("zoom-icon-out")&&e(".magazine-viewport").zoom("zoomOut")}),e("#canvas").hide(),yepnope({test:Modernizr.csstransforms,yep:["lib/turn.min.js"],nope:["lib/turn.html4.min.js","css/jquery.ui.html4.css"],both:["lib/zoom.min.js","css/jquery.ui.css","js/magazine.js","css/magazine.css"],complete:o})}(jQuery);